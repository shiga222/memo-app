<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>„ÅÇ„Å™„Åü„ÅÆ„É°„É¢Â∏≥</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      background: #f5f5f5;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 12px;
    }

    h1 { text-align: center; font-size: 22px; margin: 10px 0 16px; }
    h2 { font-size: 18px; margin-top: 16px; }

    input, textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 5px;
      font-size: 16px;
      background: #fff;
    }

    textarea { height: 140px; resize: vertical; }

    .buttons {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 12px;
    }

    button {
      padding: 10px;
      font-size: 16px;
      border-radius: 999px;
      border: none;
      background: #3f51b5;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      width: 100%;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }

    .status { margin-top: 6px; font-size: 12px; color: #444; }

    .list {
      margin-top: 10px;
      max-height: 360px;
      overflow-y: auto;
    }

    .memo-item {
      background: #fff;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
      margin-bottom: 8px;
      font-size: 14px;
    }

    .memo-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
    }

    .memo-author {
      font-weight: 600;
      font-size: 13px;
    }

    .memo-date {
      font-size: 11px;
      color: #777;
    }

    .memo-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .memo-text {
      white-space: pre-wrap;
      font-size: 13px;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>„ÅÇ„Å™„Åü„ÅÆ„É°„É¢Â∏≥</h1>

  <h2>„É°„É¢„ÇíÊõ∏„Åè</h2>
  <input id="name" placeholder="„ÅÇ„Å™„Åü„ÅÆÂêçÂâçÔºà„Éã„ÉÉ„ÇØ„Éç„Éº„É†„Åß„ÇÇOKÔºâ">
  <input id="title" placeholder="„Çø„Ç§„Éà„É´">
  <textarea id="text" placeholder="ÂÜÖÂÆπ"></textarea>

  <div class="buttons">
    <button id="send">„É°„É¢„ÇíÊäïÁ®ø„Åô„Çã</button>
  </div>

  <div class="status" id="status"></div>

  <h2>„É°„É¢</h2>
  <div class="list" id="memoList"></div>
</div>

<!-- Firebase SDKÔºà„Éê„Éº„Ç∏„Éß„É≥Áï™Âè∑„ÅØÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà„ÅÆÊúÄÊñ∞„Çí‰Ωø„Å£„Å¶OKÔºâ -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<script>
  // üî• „Åì„Åì„ÇíËá™ÂàÜ„ÅÆfirebaseConfig„Å´Â∑Æ„ÅóÊõø„Åà„Çã
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  // FirebaseÂàùÊúüÂåñ
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const nameInput = document.getElementById("name");
  const titleInput = document.getElementById("title");
  const textInput = document.getElementById("text");
  const sendButton = document.getElementById("send");
  const status = document.getElementById("status");
  const memoList = document.getElementById("memoList");

  // „É°„É¢„ÇíÊäïÁ®ø
  sendButton.onclick = async () => {
    const name = nameInput.value.trim() || "„Å™„Å™„Åó";
    const title = titleInput.value.trim() || "(ÁÑ°È°å)";
    const text = textInput.value.trim();

    if (!text) {
      status.textContent = "ÂÜÖÂÆπ„ÅåÁ©∫„ÅÆ„É°„É¢„ÅØÊäïÁ®ø„Åó„Å™„ÅÑ„Çà„ÄÇ";
      return;
    }

    status.textContent = "ÊäïÁ®ø‰∏≠‚Ä¶";

    try {
      await db.collection("memos").add({
        author: name,
        title: title,
        text: text,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      titleInput.value = "";
      textInput.value = "";
      status.textContent = "ÊäïÁ®ø„Åó„Åæ„Åó„ÅüÔºÅ";
    } catch (e) {
      console.error(e);
      status.textContent = "ÊäïÁ®ø„Å´Â§±Êïó„Åó„Åü„Åã„ÇÇ‚Ä¶„ÅÇ„Å®„Åß„ÇÑ„ÇäÁõ¥„Åó„Å¶„Åø„Å¶„ÄÇ";
    }
  };

  // „É°„É¢‰∏ÄË¶ß„Çí„É™„Ç¢„É´„Çø„Ç§„É†„ÅßÂèñÂæó
  db.collection("memos")
    .orderBy("createdAt", "desc")
    .onSnapshot((snapshot) => {
      memoList.innerHTML = "";

      snapshot.forEach((doc) => {
        const data = doc.data();
        const div = document.createElement("div");
        div.className = "memo-item";

        const createdAt = data.createdAt ? data.createdAt.toDate() : null;
        const dateText = createdAt
          ? createdAt.toLocaleString()
          : "Êó•ÊôÇ‰∏çÊòé";

        div.innerHTML = `
          <div class="memo-header">
            <div class="memo-author">${data.author || "„Å™„Å™„Åó"}</div>
            <div class="memo-date">${dateText}</div>
          </div>
          <div class="memo-title">${data.title || "(ÁÑ°È°å)"}</div>
          <div class="memo-text">${(data.text || "").replace(/</g, "&lt;")}</div>
        `;

        memoList.appendChild(div);
      });

      if (snapshot.empty) {
        const empty = document.createElement("div");
        empty.style.fontSize = "13px";
        empty.style.color = "#777";
        empty.textContent = "„Åæ„Å†„É°„É¢„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ‰∏ä„Å´Êõ∏„ÅÑ„Å¶ÊäïÁ®ø„Åó„Å¶„Åø„Å¶„Å≠„ÄÇ";
        memoList.appendChild(empty);
      }
    });
</script>
</body>
</html>
